---
title: "TanStack DB ~Áä∂ÊÖãÁÆ°ÁêÜ„ÅÆÊñ∞„Åó„ÅÑËÄÉ„ÅàÊñπ~"
emoji: "üóÉÔ∏è"
type: "tech" # tech: ÊäÄË°ìË®ò‰∫ã / idea: „Ç¢„Ç§„Éá„Ç¢
topics: [tanstackdb,tanstack,react,typescript,zennfes2025free]
published: true
---

## „ÅØ„Åò„ÇÅ„Å´

[TanStack](https://tanstack.com/) „ÅåÊñ∞„Åü„Å´ÂÖ¨Èñã„Åó„Åü **TanStack DB** „Å´„Å§„ÅÑ„Å¶Ë™ø„Åπ„Åü„ÅÆ„Åß„ÄÅ„Åù„ÅÆÊ¶ÇË¶Å„ÇíÁ¥π‰ªã„Åó„Åæ„Åô„ÄÇ

https://tanstack.com/db/latest

:::message
„Åì„Å°„Çâ„ÅÆË®ò‰∫ã„ÅØReact Tokyo „Éü„Éº„Éà„Ç¢„ÉÉ„Éó #8„Å´„Å¶Áô∫Ë°®„Åï„Åõ„Å¶„ÅÑ„Åü„Å†„ÅÑ„ÅüÂÜÖÂÆπ„Çí„Çà„ÇäÊ∑±Â†Ä„Çä„Åó„ÅüË®ò‰∫ã„Å®„Å™„Å£„Å¶„ÅÑ„Åæ„Åô„ÄÇ
ÁôªÂ£áË≥áÊñô„ÅØ„Åì„Å°„Çâ„Åß„Åô„ÄÇ
[TanStack DB ~Áä∂ÊÖãÁÆ°ÁêÜ„ÅÆÊñ∞„Åó„ÅÑËÄÉ„ÅàÊñπ~](https://speakerdeck.com/bmthd/tanstack-db-zhuang-tai-guan-li-noxin-siikao-efang)
:::

### TanStack DB„Å®„ÅØ

TanStack DB„ÅØ„ÄÅ„Éï„É≠„É≥„Éà„Ç®„É≥„Éâ„Å´ **Ê∞∏Á∂öÂåñÂ±§ÔºàDBÔºâ** „ÇíË®≠„Åë„ÄÅ„Ç≥„É≥„Éù„Éº„Éç„É≥„Éà„Åã„ÇâÁõ¥Êé•„ÇØ„Ç®„É™„Åß„Åç„Çã‰ªïÁµÑ„Åø„ÇíÊèê‰æõ„Åó„Åæ„Åô„ÄÇ

ÂæìÊù•„ÅØ„ÄÅ„Éê„ÉÉ„ÇØ„Ç®„É≥„Éâ„ÅÆDB„ÇíÊ≠£„Å®„Åó„ÄÅ„Éï„É≠„É≥„Éà„Ç®„É≥„Éâ„ÅØ„Åù„Çå„ÇíÂÆöÊúüÁöÑ„Å´Âïè„ÅÑÂêà„Çè„Åõ„ÇãÂΩ¢„Åå‰∏ÄËà¨ÁöÑ„Åß„Åó„Åü„ÄÇ
TanStack DB„ÅØ„Åì„Çå„ÇíÈÄÜËª¢„Åï„Åõ„ÄÅ**„Éï„É≠„É≥„Éà„Ç®„É≥„Éâ„Åå„Éá„Éº„Çø„ÅÆ‰∏ªÂ∞éÊ®©„ÇíÊåÅ„Å§** ÂΩ¢„Å´„Åó„Åæ„Åô„ÄÇ

„Å§„Åæ„Çä„ÄåDB„Çí„Éï„É≠„É≥„Éà„Ç®„É≥„Éâ„Å´ÊåÅ„Å£„Å¶„Åç„Åü„ÄçÊÑüË¶ö„Åß‰Ωø„Åà„Çã„ÅÆ„ÅåÈ≠ÖÂäõ„Åß„Åô„ÄÇ

## TanStack DB„ÅØ‰Ωï„ÅåÂ¨â„Åó„ÅÑ„ÅÆ„Åã

### Ê•ΩË¶≥ÁöÑÊõ¥Êñ∞„ÅÆËá™ÂãïÂåñ

Âêå„ÅòTanStack„Ç∑„É™„Éº„Ç∫„ÅÆTanStack Query„ÅØ„Éá„Éï„Ç©„É´„Éà„Åß„ÅØUI„ÅÆÊ•ΩË¶≥ÁöÑÊõ¥Êñ∞„Çí„Åó„Åæ„Åõ„Çì„ÄÇ
„Å§„Åæ„Çä„ÄÅÂ§±Êïó„Åô„Çã„Åì„Å®„ÇíÂâçÊèê„Å´„ÄÅÊàêÂäü„Åó„ÅüÂ†¥Âêà„Å†„ÅëUI„ÅåÊõ¥Êñ∞„Åï„Çå„Çã„Å®„ÅÑ„ÅÜ„Åì„Å®„Åß„Åô„ÄÇ
Ê•ΩË¶≥ÁöÑÊõ¥Êñ∞„Å´ÂØæÂøú„Åó„Åü„ÅÑÂ†¥Âêà„ÅØÊâãÂãï„Åß‰ªÆ„ÅÆÊõ¥Êñ∞„ÄÅ„É≠„Éº„É´„Éê„ÉÉ„ÇØ„ÄÅÂÜç„Éï„Çß„ÉÉ„ÉÅ„ÇíÂÆüË£Ö„Åô„ÇãÂøÖË¶Å„Åå„ÅÇ„Çä„Åæ„Åó„Åü„ÄÇ

```ts: TanStack Query„Å´„Çà„ÇãÊ•ΩË¶≥ÁöÑÊõ¥Êñ∞„ÅÆ‰æã
const mutation = useMutation({
  mutationFn: updateTodo,
  // Ê•ΩË¶≥ÁöÑÊõ¥Êñ∞„ÅÆÂÆüË£Ö
  onMutate: async (newTodo) => {
    await queryClient.cancelQueries({ queryKey: ['todos'] });
    const previousTodos = queryClient.getQueryData(['todos']);
    queryClient.setQueryData(['todos'], (old) => [...old, newTodo]);
    return { previousTodos };
  },
  onError: (err, newTodo, context) => {
    queryClient.setQueryData(['todos'], context.previousTodos);
  },
  onSettled: () => {
    queryClient.invalidateQueries({ queryKey: ['todos'] });
  },
});
```

„Åì„ÅÆ„Çà„ÅÜ„Å™Âá¶ÁêÜ„ÇíÊØéÂõûÊõ∏„Åè„ÅÆ„ÅØÈù¢ÂÄí„Åß„Åô„Åó„ÄÅ„Éü„Çπ„ÇÇËµ∑„Åì„Çä„ÇÑ„Åô„ÅÑ„Åß„Åô„ÄÇ
TanStack DB„Åß„ÅØ„ÄÅ**„É≠„Éº„Ç´„É´„ÅÆCollection„ÇíÁõ¥Êé•Êõ¥Êñ∞„Åô„Çã„Å†„Åë„Åß„ÄÅÊ•ΩË¶≥ÁöÑÊõ¥Êñ∞„ÅåËá™ÂãïÁöÑ„Å´Ë°å„Çè„Çå„Çã** „Åü„ÇÅ„ÄÅ‰∏äË®ò„ÅÆ„Çà„ÅÜ„Å™Ë§áÈõë„Å™„Ç≥„Éº„Éâ„ÇíÊõ∏„ÅèÂøÖË¶Å„Åå„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇ

```ts: TanStack DB„Å´„Çà„ÇãÊ•ΩË¶≥ÁöÑÊõ¥Êñ∞„ÅÆ‰æã
const updateTodo = async (id: string, newTodo: TODO) => {
  await todosCollection.update(id, (draft) => {
    draft = newTodo; // „Åì„Çå„Å†„Åë„ÅßÊ•ΩË¶≥ÁöÑÊõ¥Êñ∞„ÅåÂÆå‰∫Ü
  });
};
```

Âø´ÈÅ©„Å™UI„ÇíÂÆüÁèæ„Åô„Çã„ÅÜ„Åà„Åß„ÄÅÊ•ΩË¶≥ÁöÑÊõ¥Êñ∞„ÅØÈáçË¶Å„Å™Ë¶ÅÁ¥†„Åß„Åô„ÄÇ
Âá¶ÁêÜ„ÅåÂ§±Êïó„Åô„Çã„Åì„Å®„ÅØÁ®Ä„Åß„ÅÇ„ÇãÂ†¥Âêà„ÅåÂ§ö„ÅÑ„Åü„ÇÅ„ÄÅ**ÊàêÂäü„ÇíÂâçÊèê„Å´UI„ÇíÂç≥Â∫ß„Å´Êõ¥Êñ∞„Åô„Çã**„Åì„Å®„Åß„ÄÅ„É¶„Éº„Ç∂„Éº‰ΩìÈ®ì„ÅåÂêë‰∏ä„Åó„Åæ„Åô„ÄÇ

### Ê∞∏Á∂öÂåñÂ±§„ÇíËá™Áî±„Å´Â∑Æ„ÅóÊõø„ÅàÂèØËÉΩ

„Éï„É≠„É≥„Éà„Ç®„É≥„Éâ„Åß„Çπ„Éà„É¨„Éº„Ç∏„ÇíÊâ±„ÅÜÂ†¥Âêà„ÄÅlocalStorage„ÇÑIndexedDB„Å™„Å©Êßò„ÄÖ„Å™ÈÅ∏ÊäûËÇ¢„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ
„Åæ„Åü„ÄÅ„Éê„ÉÉ„ÇØ„Ç®„É≥„Éâ„Å®ÂêåÊúü„Åô„ÇãÂ†¥Âêà„ÅØSupabase„ÇÑFirebase„ÄÅGraphQL„Å™„Å©„ÅÆSaaS„ÇíÂà©Áî®„Åô„Çã„Åì„Å®„ÇÇ„ÅÇ„Çä„Åæ„Åô„ÄÇ
„Åù„Åó„Å¶„ÄÅ„Åù„Çå„Çâ„Çí„Éï„É≠„É≥„Éà„Ç®„É≥„Éâ„Åã„ÇâÂà©Áî®„Åô„ÇãÂ†¥Âêà„ÅØ„É©„ÉÉ„Éë„Éº„É©„Ç§„Éñ„É©„É™„Çí‰ΩøÁî®„Åô„Çã„ÅÆ„Åå‰∏ÄËà¨ÁöÑ„Åß„Åô„ÄÇ
‰æã„Åà„Å∞„ÄÅIndexedDB„ÅÆÂ†¥Âêà„ÅØDexie.js„ÄÅGraphQL„ÅÆÂ†¥Âêà„ÅØApollo Client„ÄÅFirebase„ÅØFirebase SDK„Å™„Å©„Åß„Åô„ÄÇ
„Åì„Çå„Çâ„ÅØ„Åù„Çå„Åû„Çå„Å´Áã¨Ëá™„ÅÆAPI„ÅÆ„Åü„ÇÅ„ÄÅ‰Ωø„ÅÑÊñπ„ÅåÁï∞„Å™„Çä„ÄÅÂ≠¶Áøí„Ç≥„Çπ„Éà„Åå„Åã„Åã„Çä„Åæ„Åô„ÄÇ
TanStack DB„ÅØÁâπÂÆö„ÅÆ„Çπ„Éà„É¨„Éº„Ç∏ÊäÄË°ì„Å´‰æùÂ≠ò„Åó„Åæ„Åõ„Çì„ÄÇ„Ç¢„ÉÄ„Éó„Çø„ÇíÂ∑Æ„ÅóÊõø„Åà„Çã„Åì„Å®„Åß„ÄÅÊßò„ÄÖ„Å™„Çπ„Éà„É¨„Éº„Ç∏„Å´ÂØæÂøú„Åß„Åç„Åæ„Åô„ÄÇ

* localStorage
* „Ç§„É≥„É°„É¢„É™
* REST API
* Electric SQL
* TrailBase

„Åæ„Åü„ÄÅÊ®ôÊ∫ñ„Åß„Çµ„Éù„Éº„Éà„Åï„Çå„Å¶„ÅÑ„Çã„Ç¢„ÉÄ„Éó„Çø‰ª•Â§ñ„Å´„ÇÇ„ÄÅÁã¨Ëá™„Å´„Ç¢„ÉÄ„Éó„Çø„ÇíÂÆüË£Ö„Åß„Åç„Åæ„Åô„ÄÇ
https://tanstack.com/db/latest/docs/guides/collection-options-creator

Supabase, IndexedDB, DuckDB Wasm„Å™„Å©„ÅÆ„Ç¢„ÉÄ„Éó„Çø„ÇÇÊäÄË°ìÁöÑ„Å´ÂÆüË£Ö„ÅåÂèØËÉΩ„Å™„Åü„ÇÅ„ÄÅÁôªÂ†¥„ÅåÊúüÂæÖ„Åï„Çå„Åæ„Åô„ÄÇ

### „Éê„ÉÉ„ÇØ„Ç®„É≥„ÉâÂÆüË£Ö„ÇíÁ∞°Á¥†Âåñ„Åß„Åç„Çã„Åã„ÇÇ

„Éï„É≠„É≥„Éà„Ç®„É≥„Éâ„ÅåÊ¨≤„Åó„ÅÑ„Éá„Éº„Çø„ÇíÁõ¥Êé•„ÇØ„Ç®„É™„Åß„Åç„Çã„Åü„ÇÅ„ÄÅ„Éê„ÉÉ„ÇØ„Ç®„É≥„Éâ„ÅÆÂÆüË£Ö„ÇíÁ∞°Á¥†Âåñ„Åß„Åç„ÇãÂèØËÉΩÊÄß„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ
TanStack DB„Çí‰Ωø„Åà„Å∞„ÄÅ„Éê„ÉÉ„ÇØ„Ç®„É≥„Éâ„Åå„ÇÑ„Çã„Åπ„Åç„Åì„Å®„ÅØ„Éá„Éº„Çø„Éô„Éº„Çπ„Çπ„Ç≠„Éº„Éû„ÅÆË®≠Ë®à„Å®„ÄÅRow Level SecurityÔºàRLSÔºâ„ÅÆË®≠ÂÆö„ÄÅË™çË®º„ÅÆÂÆüË£ÖÁ®ãÂ∫¶„Å´Áïô„ÇÅ„Çâ„Çå„Åæ„Åô„ÄÇ
‰∏äË®ò„Åß‰∏ä„Åí„Åü„ÄÅElectric SQL„Å®TrailBase„ÅØ„ÄÅ**„Éï„É≠„É≥„Éà„Ç®„É≥„Éâ„ÅÆDB„Å®„Éê„ÉÉ„ÇØ„Ç®„É≥„Éâ„ÅÆDB„ÇíËá™ÂãïÁöÑ„Å´ÂêåÊúü**„Åô„Çã‰ªïÁµÑ„Åø„ÇíÊèê‰æõ„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇ
ÂæìÊù•„ÇÇ„ÄÅSupabase„ÇÑGraphQL„ÅÆHasura, PostGraphile„Å™„Å©„Çí‰Ωø„Åà„Å∞ÂêåÊßò„ÅÆ„Åì„Å®„ÅåÂèØËÉΩ„Åß„Åó„Åü„ÄÇ

„Åó„Åã„Åó„ÄÅ„Åì„Çå„Çâ„ÅÆÊäÄË°ì„ÅØ„Åù„Çå„Åû„Çå„Å´Áã¨Ëá™„ÅÆAPI„Åå„ÅÇ„Çä„ÄÅÂ≠¶Áøí„Ç≥„Çπ„Éà„ÅåÁô∫Áîü„Åó„Å¶„Åó„Åæ„ÅÑ„Åæ„Åô„ÄÇ
„Éï„É≠„É≥„Éà„Ç®„É≥„ÉâÂÅ¥„ÅÆ„É≠„Ç∏„ÉÉ„ÇØ„ÅåÁâπÂÆö„ÅÆSaaS„Å´‰æùÂ≠ò„Åó„ÄÅÂ∞ÜÊù•UI„É©„Ç§„Éñ„É©„É™„ÇÑ„Éê„ÉÉ„ÇØ„Ç®„É≥„Éâ„ÅÆ„Å©„Å°„Çâ„Åã„ÇíÂ§âÊõ¥„Åó„Åü„ÅÑ„Å®„Å™„Å£„ÅüÂ†¥Âêà„ÄÅÁßªË°å„ÅåÂõ∞Èõ£„Å´„Å™„Çã„É™„Çπ„ÇØ„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ
TanStack DB„Åß„ÅÇ„Çå„Å∞„ÄÅ„Ç¢„ÉÄ„Éó„Çø„ÇíÂ∑Æ„ÅóÊõø„Åà„Çã„Å†„Åë„ÅßÊ∏à„ÇÄ„Åü„ÇÅ„ÄÅÁâπÂÆö„ÅÆ„Çπ„Éà„É¨„Éº„Ç∏ÊäÄË°ì„Å´‰æùÂ≠ò„Åó„Å™„ÅÑ„ÅßÊ∏à„Åø„Åæ„Åô„ÄÇ
„Å©„ÅÆ„Éê„ÉÉ„ÇØ„Ç®„É≥„Éâ„ÇíÊé°Áî®„Åó„Å¶„ÅÑ„Åü„Å®„Åó„Å¶„ÇÇ„ÄÅ„Éï„É≠„É≥„Éà„Ç®„É≥„ÉâÂÅ¥„ÅÆÂÆüË£Ö„ÅØÂ§â„Çè„Çä„Åæ„Åõ„Çì„ÄÇ
„Åó„Åã„ÇÇ„ÄÅUI„É©„Ç§„Éñ„É©„É™„ÇÇ„Éû„É´„ÉÅ„Éï„É¨„Éº„É†„ÉØ„Éº„ÇØ„Å´ÂØæÂøú„Åó„Å¶„ÅÑ„Çã„Åü„ÇÅ„ÄÅReact„Åã„ÇâSvelte„Å´‰πó„ÇäÊèõ„Åà„Åü„Åè„Å™„Å£„ÅüÂ†¥Âêà„Åß„ÇÇÂ∑Æ„ÅóÊõø„Åà„ÅåÂÆπÊòì„Åß„Åô„ÄÇ

---

## ‰Ωø„ÅÑÊñπ

Êó©ÈÄü‰Ωø„ÅÑÊñπ„ÇíË™¨Êòé„Åó„Å¶„ÅÑ„Åç„Åæ„Åô„ÄÇ
‰ªäÂõû„ÅØReact„Åß„ÅÆÂà©Áî®„Çí„Éô„Éº„Çπ„Å´Ëß£Ë™¨„Åó„Å¶„ÅÑ„Åç„Åæ„Åô„ÄÇ

:::message
TanStack DB„ÅØ„Åæ„Å†v0„ÅÆ„Åü„ÇÅ„ÄÅAPI„ÅØÂ§â„Çè„ÇãÂèØËÉΩÊÄß„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ
:::

TanStack DB„ÅÆ„Éë„ÉÉ„Ç±„Éº„Ç∏„ÅØ‰ª•‰∏ã„ÅÆÈÄö„Çä„Åß„Åô„ÄÇ

```bash
npm install @tanstack/db @tanstack/react-db
```

### Collection„ÅÆÂÆöÁæ©„Å®„ÇØ„Ç®„É™

„Åæ„Åö„ÅØ„Éá„Éº„Çø„ÇíÊ∞∏Á∂öÂåñ„Åô„Çã„Åü„ÇÅ„ÅÆCollection„ÇíÂÆöÁæ©„Åó„Åæ„Åô„ÄÇ

```ts
import { createCollection, localStorageCollectionOptions } from "@tanstack/db";
import * as v from "valibot"; 

const drawCalcSchema = v.object({
  id: v.string(),
  name: v.string(),
  gameTemplate: v.string(),
  result: v.string(),
  createdAt: v.date(),
  updatedAt: v.date(),
});

export const drawCalcCollection = createCollection(
  localStorageCollectionOptions({
    storageKey: "tcg-tool-draw-calculations",
    id: "draw-calculations",
    getKey: (item) => item.id,
    schema: drawCalcSchema
  }),
);

// „ÇÇ„Åó„Åè„ÅØ

type DrawCalc = {
  id: string;
  name: string;
  gameTemplate: string;
  result: string;
  createdAt: Date;
  updatedAt: Date;
};

export const drawCalcCollection = createCollection(
  localStorageCollectionOptions<DrawCalc>({
    storageKey: "tcg-tool-draw-calculations",
    id: "draw-calculations",
    getKey: (item) => item.id,
  }),
);
```

„Åì„ÅÆCollection„ÅØSQL„Åß„ÅÑ„ÅÜ„ÉÜ„Éº„Éñ„É´„Å´Áõ∏ÂΩì„Åó„Åæ„Åô„ÄÇ
ÂûãÂÆöÁæ©„ÅØÂûã„Éë„É©„É°„Éº„Çø„Å®„Åó„Å¶Ê∏°„Åó„Å¶„ÇÇËâØ„ÅÑ„Åó„ÄÅZod„ÇÑValibot„Å™„Å©„ÅÆ„É©„É≥„Çø„Ç§„É†„Éê„É™„Éá„Éº„Ç∑„Éß„É≥„ÅÆ„Çπ„Ç≠„Éº„Éû„ÇíÊ∏°„Åó„Å¶Êé®Ë´ñ„Åï„Åõ„Çã„Åì„Å®„ÇÇ„Åß„Åç„Åæ„Åô„ÄÇ

Á∂ö„ÅÑ„Å¶„ÄÅ„ÇØ„Ç®„É™„Åß„Éá„Éº„Çø„ÇíÂèñÂæó„Åó„Åæ„Åô„ÄÇ

```ts
import { useLiveQuery } from "@tanstack/react-db";
import { eq } from "@tanstack/db";

const { data } = useLiveQuery((q) =>
  q
    .from({ calculations: calculationsCollection })
    .where(({ calculations }) => eq(calculations.id, calculationId))
    .select({
      id: calculations.id,
      name: calculations.name,
      result: calculations.result,
    })
    .orderBy(({ calculations }) => calculations.updatedAt, "desc"),
);
```

`useLiveQuery`„ÇíÂà©Áî®„Åô„Çã„Åì„Å®„Åß„ÄÅ„Çπ„Éà„É¨„Éº„Ç∏„Çí„É™„Ç¢„É´„Çø„Ç§„É†„ÅßË≥ºË™≠„Åó„ÄÅ„Åù„ÅÆÂ§âÊõ¥„Å´Âøú„Åò„Å¶„Ç≥„É≥„Éù„Éº„Éç„É≥„Éà„ÅåÂÜç„É¨„É≥„ÉÄ„É™„É≥„Ç∞„Åï„Çå„Çã„Çà„ÅÜ„Å´„Å™„Çä„Åæ„Åô„ÄÇ
„Ç§„É°„Éº„Ç∏„Å®„Åó„Å¶„ÅØ„ÄÅRedux„ÅÆ`useSelector`„Å®Âêå„Åò„Åß„Åô„Åå„ÄÅ„Åù„ÅÆ„Çª„É¨„ÇØ„Çø„ÉºÈÉ®ÂàÜ„ÅåSQL„É©„Ç§„ÇØ„Å™„ÇØ„Ç®„É™„ÅßÊõ∏„Åë„Çã„Çà„ÅÜ„Å´„Å™„Å£„Å¶„ÅÑ„Åæ„Åô„ÄÇ
Redux„ÅÆ„Çª„É¨„ÇØ„Çø„Éº„ÅØJavaScript„ÅßË®òËø∞„Åô„Çã„Åü„ÇÅÊüîËªüÊÄß„Åå„ÅÇ„Çä„Åæ„Åô„Åå„ÄÅ„Åù„ÅÆÂàÜ„Ç¢„ÇØ„Çª„ÇπÊñπÊ≥ï„ÅåÂÆö„Åæ„Çä„Åæ„Åõ„Çì„ÄÇ
„Åì„Åì„Çí**SQL„É©„Ç§„ÇØ„Å™API„ÅßÁµ±‰∏Ä„Åô„Çã„Åì„Å®„Å´„Çà„Çä„ÄÅÂäπÁéá„ÅÆËâØ„ÅÑ„Éá„Éº„ÇøÂèñÂæó„Å®Ë™çÁü•Ë≤†Ëç∑„ÅÆËªΩÊ∏õ**„ÅåÊúüÂæÖ„Åß„Åç„Åæ„Åô„ÄÇ
„Åì„Çå„ÅØÁõÆ„Åã„ÇâÈ±ó„ÅÆÁô∫ÊÉ≥„Åß„Åó„Åü„ÄÇ

:::message
ÁèæÁä∂„Åß„ÅØÂêÑUI„É©„Ç§„Éñ„É©„É™Âêë„Åë„ÅÆ„Ç§„É≥„ÉÜ„Ç∞„É¨„Éº„Ç∑„Éß„É≥API„ÅØ„Åù„Çå„Åû„Çå1„Å§„Åö„Å§„ÅÆ„Åø„Å®„Å™„Å£„Å¶„Åä„Çä„ÄÅ„Å®„Å¶„ÇÇ„Ç∑„É≥„Éó„É´„Åß„Åô„ÄÇ
React„ÅÆÂ†¥Âêà„ÅØSuspense„Çí‰Ωø„Å£„Å¶Ë™≠„ÅøËæº„Åø„Çí„Åó„Åü„ÅÑ„Å®„Åì„Çç„Åß„Åô„Åå„ÄÅÁèæÊôÇÁÇπ„Åß„ÅØ`isLoading`, `isError`„ÇíÁ¢∫Ë™ç„Åó„Å¶Ëá™Ââç„ÅßÂà∂Âæ°„Åó„Å™„Åë„Çå„Å∞„Å™„Çä„Åæ„Åõ„Çì„ÄÇ
`useSuspenseLiveQuery`„ÇÑ`{ suspense: true }`„Ç™„Éó„Ç∑„Éß„É≥„ÅÆËøΩÂä†„ÇíÊúüÂæÖ„Åó„Åü„ÅÑ„Åß„Åô„Å≠„ÄÇ
:::

### Ê¥æÁîüCollection

„ÇØ„Ç®„É™„Çí„ÅÇ„Çâ„Åã„Åò„ÇÅÂÆöÁæ©„Åó„Åü„ÄåÊ¥æÁîüCollection„Äç„ÇÇ‰Ωú„Çå„Åæ„Åô„ÄÇ

```ts
// Â±•Ê≠¥Áî®„Ç≥„É¨„ÇØ„Ç∑„Éß„É≥
export const drawCalcHistoryCollection = createLiveQueryCollection((q) =>
  q.from({ calculations: drawCalcCollection })
   .orderBy(({ calculations }) => calculations.updatedAt, "desc"),
);

// ÂºïÊï∞‰ªò„Åç„Ç≥„É¨„ÇØ„Ç∑„Éß„É≥
export const createDrawCalcByGameCollection = (gameTemplate: string) =>
  createLiveQueryCollection((q) =>
    q.from({ calculations: drawCalcCollection })
     .where(({ calculations }) => eq(calculations.gameTemplate, gameTemplate))
     .orderBy(({ calculations }) => calculations.updatedAt, "desc"),
  );
```

„Åì„Çå„Å´„Çà„Çä„ÄåÂà©Áî®È†ªÂ∫¶„ÅÆÈ´ò„ÅÑ„ÇØ„Ç®„É™„Äç„ÇíÂÜçÂà©Áî®ÂèØËÉΩ„Å™ÂΩ¢„Åß„Åæ„Å®„ÇÅ„Çâ„Çå„Åæ„Åô„ÄÇ

### „Ç≥„É≥„Éù„Éº„Éç„É≥„Éà„Åß„ÅÆÂà©Áî®

```tsx:Ë¶™„Ç≥„É≥„Éù„Éº„Éç„É≥„Éà
const CalculationList = () => {
  const { data } = useLiveQuery((q) =>
    q
      .from({ calculations: calculationsCollection })
      .select({
        id: calculations.id, // id„Å†„Åë„Çíselect„Åó„Å¶„ÅÑ„Çã„ÅÆ„Åß„ÄÅ„Åì„ÅÆÈÉ®ÂàÜ„ÅÆ„Åø„Å´ÂèçÂøú„Åô„Çã
      })
  );

  return (
    <>
      {data.map((item) => (
        <CalculationItem key={item.id} calculationId={item.id} />
      ))}
    </>
  );
};
```

```tsx:Â≠ê„Ç≥„É≥„Éù„Éº„Éç„É≥„Éà
const CalculationItem = ({ calculationId }: { calculationId: string }) => {
  const { data } = useLiveQuery((q) =>
    q.from({ calculations: calculationsCollection })
      // ÁâπÂÆö„ÅÆid„ÅÆCollection„ÅÆÂ§âÊõ¥„ÅÆ„Åø„Å´ÂèçÂøú„Åô„Çã
      .where(({ calculations }) => eq(calculations.id, calculationId)), 
  );

  const [calculation] = data
  if (!calculation) return <FallbackItem />;

  return (
    <Card.Root>
      <Card.Header>
        {calculation.name}
      </Card.Header>
      <Card.Body>
        {calculation.result}
      </Card.Body>
    </Card.Root>
  );
}
```

„Åì„ÅÆ„Çà„ÅÜ„Å´„ÄÅ„Ç≥„É≥„Éù„Éº„Éç„É≥„Éà„ÅÆ‰∏≠„ÅßÁõ¥Êé•„ÇØ„Ç®„É™„ÇíÊõ∏„Åç„ÄÅÈÉ®ÂàÜÁöÑ„Å´Ë≥ºË™≠ÂèØËÉΩ„Åß„Åô„ÄÇ

---

## „Åä„Åæ„Åë

### Áä∂ÊÖãÁÆ°ÁêÜ„ÅÆ„Éô„Çπ„Éà„Éó„É©„ÇØ„ÉÜ„Ç£„Çπ„ÇíÂ§â„Åà„Çã

„Åì„Çå„Åæ„Åß„Éá„Éº„Çø„Éï„Çß„ÉÉ„ÉÅ„ÇÑ„Éê„ÉÉ„ÇØ„Ç®„É≥„Éâ„Å®„ÅÆÂêåÊúü„Çí‰∏ªËª∏„Å´Êõ∏„ÅÑ„Å¶„Åç„Åæ„Åó„Åü„Åå„ÄÅ„É≠„Éº„Ç´„É´„Å™Áä∂ÊÖãÁÆ°ÁêÜ„ÇÇTanStack DB„ÅåÁΩÆ„ÅçÊèõ„Åà„Å¶„Åó„Åæ„ÅÜ„ÅÆ„Åß„ÅØ„Å®ËÄÉ„Åà„Å¶„ÅÑ„Åæ„Åô„ÄÇ
‰ªä„Åæ„ÅßJotai„ÇÑZustand„Å™„Å©„ÅßÁä∂ÊÖãÁÆ°ÁêÜ„Åó„Å¶„ÅÑ„ÅüÈÉ®ÂàÜ„Åß„Åô„ÄÇ
„Åì„Çå„Çâ„ÅØË§áÈõë„Å™„Éá„Éº„ÇøÊßãÈÄ†„ÇíË°®Áèæ„Åó„Çà„ÅÜ„Å®„Åô„Çã„Å®„ÄÅÁä∂ÊÖã„ÅÆÊ≠£Ë¶èÂåñ„ÇÑ„Çª„É¨„ÇØ„Çø„Éº„ÅÆÂÆüË£Ö„ÅåÂøÖË¶Å„Å´„Å™„Çä„ÄÅË™çÁü•Ë≤†Ëç∑„ÅåÈ´ò„Åè„Å™„Çä„Åå„Å°„Åß„Åô„ÄÇ
„Éá„Éº„Çø„ÅÆ„ÅÇ„Çã„Åπ„ÅçÂßø„Çí„Çπ„Ç≠„Éº„Éû„ÅßÂÆöÁæ©„Åó„ÄÅÊìç‰Ωú„ÇíSQL„É©„Ç§„ÇØ„Å™„ÇØ„Ç®„É™„ÅßË°å„ÅÜ„Åì„Å®„Åå„Åß„Åç„Çã„Åü„ÇÅ„ÄÅ**Áä∂ÊÖãÁÆ°ÁêÜ„ÅÆ„Éô„Çπ„Éà„Éó„É©„ÇØ„ÉÜ„Ç£„Çπ„ÇíÂ§ß„Åç„ÅèÂ§â„Åà„ÇãÂèØËÉΩÊÄß„Åå„ÅÇ„Çä„Åæ„Åô**„ÄÇ
„Åù„Åó„Å¶„ÄÅ„Åù„Çå„Çâ„Çí„Åù„ÅÆ„Åæ„Åæ„Éê„ÉÉ„ÇØ„Ç®„É≥„Éâ„Å´ÂêåÊúü„Åß„Åç„ÇãÁÇπ„ÇÇË¶ãÈÄÉ„Åõ„Åæ„Åõ„Çì„ÄÇ

### ÊÉ≥ÂÆö„Åï„Çå„Çã„É¶„Éº„Çπ„Ç±„Éº„Çπ

„Åß„ÅØ‰∏Ä‰Ωì„Å©„Çì„Å™Â†¥Èù¢„Åß‰Ωø„ÅÜ„Å®ÂäπÊûúÁöÑ„Å™„ÅÆ„Åã„ÄÅÂ∞ë„ÅóËÄÉ„Åà„Å¶„Åø„Åæ„Åó„Åü„ÄÇ

1. **„É™„Ç¢„É´„Çø„Ç§„É†ÊÄß„ÅåÊ±Ç„ÇÅ„Çâ„Çå„Çã„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥**

   „ÉÅ„É£„ÉÉ„Éà„Ç¢„Éó„É™„ÇÑ„Ç≥„É©„Éú„É¨„Éº„Ç∑„Éß„É≥„ÉÑ„Éº„É´„Å™„Å©„ÄÅ„Éá„Éº„Çø„ÅÆÂ§âÊõ¥„ÅåÂç≥Â∫ß„Å´ÂèçÊò†„Åï„Çå„Çã„Åì„Å®„ÅåÈáçË¶Å„Å™Â†¥Âêà„ÄÇ
   ‰æã„Åà„Å∞„ÄÅMiro„ÇÑFigma„ÄÅGoogle Spreadsheet„ÅÆ„Çà„ÅÜ„Å™ÂÖ±ÂêåÁ∑®ÈõÜ„ÉÑ„Éº„É´„ÄÇ

2. **„Ç™„Éï„É©„Ç§„É≥„Åß„ÅÆÂà©Áî®„ÅåÊ±Ç„ÇÅ„Çâ„Çå„Çã„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥**

   „Éç„ÉÉ„Éà„ÉØ„Éº„ÇØ„Åå‰∏çÂÆâÂÆö„Å™Áí∞Â¢É„Åß„ÇÇÂø´ÈÅ©„Å´Âãï‰Ωú„Åô„Çã„Åì„Å®„ÇíÊ±Ç„ÇÅ„Çâ„Çå„ÇãÂ†¥Âêà„ÄÇ
   ‰æã„Åà„Å∞„ÄÅÂª∫Ë®≠Ê•≠„ÄÅ„Éï„Ç£„Éº„É´„Éâ„ÉØ„Éº„ÇØ„ÄÅÂåªÁôÇÁèæÂ†¥„Å™„Å©„ÄÇ
   
3. **Â§ßÂÆπÈáè„ÅÆ„Éá„Éº„Çø„ÅÆÂàÜÊûê„ÇÑÂèØË¶ñÂåñ„ÅåÊ±Ç„ÇÅ„Çâ„Çå„Çã„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥**

   Â§ßÈáè„ÅÆ„Éá„Éº„Çø„ÇíÂäπÁéáÁöÑ„Å´Âá¶ÁêÜ„Åó„ÄÅ„É¶„Éº„Ç∂„Éº„Å´ÂàÜ„Åã„Çä„ÇÑ„Åô„ÅèÊèêÁ§∫„Åô„Çã„Åì„Å®„ÅåÊ±Ç„ÇÅ„Çâ„Çå„ÇãÂ†¥Âêà„ÄÇ
   ‰æã„Åà„Å∞„ÄÅ„ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„Éâ„ÇÑBI„ÉÑ„Éº„É´„ÄÅÊ†™ÂèñÂºï„Ç¢„Éó„É™„Åß„ÅÆÂà©Áî®„Å™„Å©„ÄÇ

### ÂÆüÈöõ„Å´Ëß¶„Å£„Å¶„Åø„Åü

Claude Code„Å®‰∏ÄÁ∑í„Å´Êó¢Â≠ò„Ç¢„Éó„É™„ÇíTanStack DB„Å´Ëºâ„ÅõÊõø„Åà„Å¶„Åø„Åæ„Åó„Åü„ÄÇ

* ÂÖ¨Èñã„Éá„É¢: [https://tcg-tool.pages.dev/draw-calc-db](https://tcg-tool.pages.dev/draw-calc-db)
* „ÇΩ„Éº„Çπ„Ç≥„Éº„Éâ: [https://github.com/bmthd/tcg-tool/pull/3/files](https://github.com/bmthd/tcg-tool/pull/3/files)

„Åì„ÅÆ„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„ÅØlocalStorage„ÅÆ„Åø„Å´„Éá„Éº„Çø„Çí‰øùÂ≠ò„Åô„Çã„Ç∑„É≥„Éó„É´„Å™Ë®àÁÆó„Ç¢„Éó„É™„Åß„Åô„Åå„ÄÅÁä∂ÊÖãÁÆ°ÁêÜ„Ç¢„Éó„É™„ÇíÊé°Áî®„Åõ„Åö„Å´TanStack DB„Å†„Åë„ÅßÂÆüË£Ö„Åß„Åç„Åæ„Åó„Åü„ÄÇ
Êõ∏„ÅçÂøÉÂú∞„ÅåËâØ„Åè„ÄÅÁä∂ÊÖãÁÆ°ÁêÜ„Å®„Éá„Éº„Çø‰øùÁÆ°„ÅåÁµ±Âêà„Åï„Çå„Å¶„ÅÑ„Çã„Åü„ÇÅ„ÄÅ„Ç≥„Éº„Éâ„Åå„Ç∑„É≥„Éó„É´„Å´„Å™„Çä„Åæ„Åó„Åü„ÄÇ

---

## „Åæ„Å®„ÇÅ

* TanStack DB„ÅØ„Äå**„Éï„É≠„É≥„Éà„Ç®„É≥„Éâ‰∏≠ÂøÉ„ÅÆ„Éá„Éº„ÇøË®≠Ë®à**„Äç„ÇíÂä†ÈÄü„Åô„Çã
* „Åô„Åπ„Å¶„ÅÆServer State„ÅÆÊäΩË±°Âåñ„É¨„Ç§„É§„Éº„Å´„Å™„Çä„ÅÜ„Çã
* Áä∂ÊÖãÁÆ°ÁêÜ„Å®„Éá„Éº„Çø‰øùÁÆ°„ÇíÁµ±Âêà„Åó„ÄÅ„Éê„ÉÉ„ÇØ„Ç®„É≥„ÉâË®≠Ë®à„Å´„ÇÇÂΩ±Èüø„Çí‰∏é„Åà„ÇãÂèØËÉΩÊÄß„Åå„ÅÇ„Çã

‰ªäÂæå„ÅÆ„Ç¢„ÉÉ„Éó„Éá„Éº„Éà„Åß„Å©„ÅÆ„Çà„ÅÜ„Å´ÈÄ≤Âåñ„Åó„Å¶„ÅÑ„Åè„ÅãÈùûÂ∏∏„Å´Ê•Ω„Åó„Åø„Åß„Åô„ÄÇ
